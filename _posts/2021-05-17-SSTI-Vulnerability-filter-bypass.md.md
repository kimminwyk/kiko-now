---
layout: post
title:  "SSTI Vulnerability filter Bypass"
tags: [SSTI, bypass]
excerpt: "SSTI(Server Side Template Injection) 취약점은 공격자가 서버측의 기본 템플릿 구문을 이용하여 악성 페이로드를 삽입 한 다음 서버 측에 실행되면서 생기는 취약점이며 웹 템플릿 엔진마다 사용되는 페이로드가 다릅니다."
---

SSTI(Server Side Template Injection)는 공격자가 서버측의 기본 템플릿 구문을 이용하여 발생시키는 취약점 입니다.

만약 SSTI취약점에 대해 예시를 보고싶다면 [해당 블로그](https://me2nuk.com/SSTI-Vulnerability/)를 참고하면 됩니다.

* * *

## SSTI Example

SSTI 취약점 우회 방식을 예시로 들기 위해 

```py
from flask import Flask, render_template_string

app = Flask(__name__)

@app.route('/')
def index():
    payload = request.args.get('p','')

    filter = [filter list]

    for _ in filter:
        if payload.find(_) != -1:
            return 'Error'

    return render_template_string(payload)

app.run('127.0.0.1', 8080)
```

해당 소스코드를 이용하여 로컬에서 render_template_string메소드로 취약점을 발생시키겠습니다.

* * *

## SSTI filter bypass

### # ``__`` filter

``__`` filter

payloads 

```jinja
{{  }}
```

### # ``.`` filter

### # ``[]`` filter

### # ``()`` filter

### # ``class`` filter

### # ``mro`` filter

### # ``classes`` filter

### # ``config`` filter
